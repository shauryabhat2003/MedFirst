<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <title>Med-Connect</title>
    <script src="http://localhost:3000/socket.io/socket.io.js"></script>



    <style>
        body {

            background-image: linear-gradient(15deg, #13547a 0%, #80d0c7 100%);
        }

        .container {
            border: 2px solid gray;
            border-radius: 12px;
            padding: 12px;
            color: black;
            margin: auto;
            max-width: 955px;
            height: 60vh;
            overflow-y: auto;
            margin-top: 12px;
            margin-bottom: 32px;
        }

        .left {
            float: left;
            clear: both;
        }

        .right {
            float: right;
            clear: both;
        }

        .message {
            background-color: gray;
            width: 24%;
            padding: 10px;
            margin: 17px 12px;
            border: 2px solid black;
            border-radius: 12px;
        }

        #send-container {
            display: flex;
            justify-content: center;
            align-items: center;
            max-width: 985px;
            margin: auto;
            margin-top: 12px;
            margin-bottom: 32px;
        }

        #messageInp {
            width: 70%;
            border: 2px solid black;
            border-radius: 6px;
            height: 34px;
            padding: 4px; /* Added padding for better visual */
        }

        .btn {
            cursor: pointer;
            border: 2px solid black;
            border-radius: 6px;
            height: 34px;
            color: white;
            background-color: #007BFF; /* Added background color */
            margin-left: 8px; /* Added margin for better visual */
        }

        /* Added hover effect for the button */
        .btn:hover {
            background-color: #0056b3;
        }

    </style>

</head>

<body>

<!-- NAVBAR -->
<%- include('partials/Navbar.ejs') %>

<!-- CHAT INTERFACE -->

    <h1 style="text-align: center;">
        Med-Connect
    </h1>

    <div class="container">

    </div>

    <div class="send">
        <form action="#" id="send-container">
            <input type="text" name="messageInp" id="messageInp">
            <button class="btn" type="submit">Send</button>

        </form>
    </div>


<!-- FOOTER -->
<%- include('partials/Footer.ejs') %>


<script>
    const socket = io('http://localhost:3000');
    const form = document.getElementById('send-container');
    const messageInput = document.getElementById('messageInp');
    const messageContainer = document.querySelector('.container');
    var audio = new Audio('ting.mp3');

    //  append new user
    const append = (message, position) => {
        const messageElement = document.createElement('div');
        messageElement.innerText = message;
        messageElement.classList.add('message');
        messageElement.classList.add(position);
        messageContainer.append(messageElement);
        if (position == 'left') {
            audio.play();

        }
    }

    // for form

    form.addEventListener('submit', (e) => {
        e.preventDefault();
        const message = messageInput.value;
        append(`You: ${message}`, 'right');
        socket.emit('send', message);
        messageInput.value = '';
    })

    const name = prompt('Enter your name');
    socket.emit('new-user-joined', name);
    console.log("Woking ")

    socket.on('user-joined', name => {
        append(`${name} joined the chat `, 'right')
    })

    socket.on('receive', data => {
        append(`${data.name}:${data.message}`, 'left')
    })


    socket.on('left', data => {
        append(`${data.name} is offline`, 'right')
    })

</script>


</body>


</html>